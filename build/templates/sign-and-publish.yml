parameters:
  displayName: '.NET Framework Executable'
  path: ''

steps:
- task: PowerShell@2
  displayName: 'Sign ${{ parameters.displayName }}'
  inputs:
    targetType: inline
    ignoreLASTEXITCODE: true
    script: |
      . ./build/sign/sign-linux.ps1
      $result = Update-AllFiles "${{ parameters.path }}" -Pin "$(CODESIGN_PIN)"
      Write-Host "##vso[task.setvariable variable=CodeSignSuccess;]$result"

- task: PublishPipelineArtifact@1
  displayName: 'Publish ${{ parameters.displayName }} (signed)'
  condition: eq(variables['CodeSignSuccess'], true)
  inputs:
    targetPath: '${{ parameters.path }}' 
    artifactName: '${{ parameters.displayName }}'
